<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç (Vue.js)</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Vue.js -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .message-bot {
            @apply bg-gray-100 text-gray-800 rounded-lg rounded-tl-none p-3 self-start max-w-[80%];
        }
        
        .message-user {
            @apply gradient-bg text-white rounded-lg rounded-tr-none p-3 self-end max-w-[80%];
        }
    </style>
</head>
<body class="bg-gray-100">
    <div id="app">
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="gradient-bg text-white shadow-lg">
            <div class="container mx-auto px-4 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-wallet text-2xl"></i>
                        <span class="text-xl font-bold">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç (Vue.js)</span>
                    </div>
                    <div class="flex items-center space-x-4">
                        <span v-if="currentUser" class="text-sm">
                            <i class="fas fa-user mr-1"></i>{{ currentUser.nickname }}
                        </span>
                        <button v-if="currentUser" @click="logout" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600">
                            <i class="fas fa-sign-out-alt mr-2"></i>–í—ã–π—Ç–∏
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
        <div v-if="message.show" :class="['fixed top-20 right-4 z-50 p-4 rounded-lg shadow-lg text-white', 
            message.type === 'success' ? 'bg-green-500' : 'bg-red-500']">
            {{ message.text }}
        </div>

        <!-- –§–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –µ—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω) -->
        <div v-if="!currentUser" class="container mx-auto px-4 py-8">
            <div class="max-w-4xl mx-auto">
                <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                    <div class="p-6">
                        <h1 class="text-3xl font-bold text-center mb-8">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç</h1>
                        
                        <div class="grid md:grid-cols-2 gap-8">
                            <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h2 class="text-2xl font-bold mb-6 text-purple-600">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
                                
                                <div class="mb-4">
                                    <label class="block text-gray-700 font-medium mb-2">–ò–º—è</label>
                                    <input v-model="registerForm.name" type="text" 
                                           class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                                </div>
                                
                                <div class="mb-4">
                                    <label class="block text-gray-700 font-medium mb-2">–§–∞–º–∏–ª–∏—è</label>
                                    <input v-model="registerForm.surname" type="text" 
                                           class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                                </div>
                                
                                <div class="mb-4">
                                    <label class="block text-gray-700 font-medium mb-2">–î–æ—Ö–æ–¥ –≤ –º–µ—Å—è—Ü</label>
                                    <input v-model="registerForm.income" type="number" 
                                           class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                                </div>
                                
                                <div class="mb-4">
                                    <label class="block text-gray-700 font-medium mb-2">–ù–∏–∫–Ω–µ–π–º (–¥–ª—è –ø–æ–∏—Å–∫–∞ –¥—Ä—É–∑–µ–π)</label>
                                    <input v-model="registerForm.nickname" type="text" 
                                           class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-500"
                                           placeholder="@username">
                                    <p class="text-xs text-gray-500 mt-1">–î–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º</p>
                                </div>
                                
                                <div class="mb-4">
                                    <label class="block text-gray-700 font-medium mb-2">–õ–æ–≥–∏–Ω (–¥–ª—è –≤—Ö–æ–¥–∞)</label>
                                    <input v-model="registerForm.login" type="text" 
                                           class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                                    <p class="text-xs text-gray-500 mt-1">–î–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º</p>
                                </div>
                                
                                <div class="mb-6">
                                    <label class="block text-gray-700 font-medium mb-2">–ü–∞—Ä–æ–ª—å</label>
                                    <input v-model="registerForm.password" type="password" 
                                           class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                                </div>
                                
                                <button @click="handleRegister" 
                                        class="w-full gradient-bg text-white py-3 rounded-lg font-semibold hover:shadow-lg">
                                    <i class="fas fa-user-plus mr-2"></i>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                                </button>
                            </div>
                            
                            <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
                            <div class="bg-gray-50 rounded-xl p-6">
                                <h2 class="text-2xl font-bold mb-6 text-purple-600">–í—Ö–æ–¥</h2>
                                
                                <div class="mb-4">
                                    <label class="block text-gray-700 font-medium mb-2">–õ–æ–≥–∏–Ω</label>
                                    <input v-model="loginForm.login" type="text" 
                                           class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                                </div>
                                
                                <div class="mb-6">
                                    <label class="block text-gray-700 font-medium mb-2">–ü–∞—Ä–æ–ª—å</label>
                                    <input v-model="loginForm.password" type="password" 
                                           class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                                </div>
                                
                                <button @click="handleLogin" 
                                        class="w-full gradient-bg text-white py-3 rounded-lg font-semibold hover:shadow-lg">
                                    <i class="fas fa-sign-in-alt mr-2"></i>–í–æ–π—Ç–∏
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) -->
        <div v-else class="container mx-auto px-4 py-8">
            <!-- –¢–∞–±—ã -->
            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="flex flex-wrap border-b">
                    <button v-for="tab in tabs" :key="tab.id" 
                            @click="currentTab = tab.id"
                            :class="['flex items-center px-6 py-3 text-sm font-medium',
                                     currentTab === tab.id 
                                         ? 'text-purple-600 border-b-2 border-purple-600' 
                                         : 'text-gray-500 hover:text-gray-700']">
                        <i :class="['mr-2', tab.icon]"></i>
                        {{ tab.name }}
                    </button>
                </div>

                <!-- –í–∫–ª–∞–¥–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
                <div v-show="currentTab === 'profile'" class="p-6">
                    <h2 class="text-2xl font-bold mb-6">–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h2>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="bg-gray-50 rounded-xl p-6">
                            <h3 class="text-lg font-semibold mb-4">–õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between pb-2 border-b">
                                    <span class="text-gray-600">–ò–º—è:</span>
                                    <span class="font-semibold">{{ currentUser.name }} {{ currentUser.surname }}</span>
                                </div>
                                <div class="flex justify-between pb-2 border-b">
                                    <span class="text-gray-600">–ù–∏–∫–Ω–µ–π–º:</span>
                                    <span class="font-semibold text-purple-600">{{ currentUser.nickname }}</span>
                                </div>
                                <div class="flex justify-between pb-2 border-b">
                                    <span class="text-gray-600">–õ–æ–≥–∏–Ω:</span>
                                    <span class="font-semibold">{{ currentUser.login }}</span>
                                </div>
                                <div class="flex justify-between pb-2 border-b">
                                    <span class="text-gray-600">–î–æ—Ö–æ–¥:</span>
                                    <span class="font-semibold">{{ currentUser.income }} ‚ÇΩ</span>
                                </div>
                                <div class="flex justify-between pb-2 border-b">
                                    <span class="text-gray-600">–ö–§–ì:</span>
                                    <span class="font-semibold text-purple-600">{{ kfg }}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gray-50 rounded-xl p-6">
                            <h3 class="text-lg font-semibold mb-4">–ö—Ä–∞—Ç–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                            <div class="space-y-4">
                                <div class="gradient-bg text-white rounded-lg p-4">
                                    <p class="text-sm opacity-90">–û–±—â–∏–π –¥–æ—Ö–æ–¥</p>
                                    <p class="text-2xl font-bold">{{ totalIncome }} ‚ÇΩ</p>
                                </div>
                                <div class="gradient-bg text-white rounded-lg p-4">
                                    <p class="text-sm opacity-90">–û–±—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã</p>
                                    <p class="text-2xl font-bold">{{ totalExpenses }} ‚ÇΩ</p>
                                </div>
                                <div class="gradient-bg text-white rounded-lg p-4">
                                    <p class="text-sm opacity-90">–û—Å—Ç–∞—Ç–æ–∫</p>
                                    <p class="text-2xl font-bold">{{ balance }} ‚ÇΩ</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –í–∫–ª–∞–¥–∫–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ -->
                <div v-show="currentTab === 'expenses'" class="p-6">
                    <h2 class="text-2xl font-bold mb-6">–†–∞—Å—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h2>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
                        <div v-for="(value, category) in expenseCategories" :key="category" class="bg-gray-50 rounded-lg p-4">
                            <label class="block text-gray-700 font-medium mb-2">
                                <i :class="['mr-1', categoryIcons[category]]"></i>
                                {{ categoryNames[category] }}
                            </label>
                            <input v-model.number="expenses[category]" type="number" min="0" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-purple-500">
                        </div>
                    </div>
                    <button @click="saveExpenses" class="mt-6 gradient-bg text-white px-8 py-3 rounded-lg font-semibold hover:shadow-lg">
                        <i class="fas fa-save mr-2"></i>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞—Å—Ö–æ–¥—ã
                    </button>
                </div>

                <!-- –í–∫–ª–∞–¥–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ -->
                <div v-show="currentTab === 'analytics'" class="p-6">
                    <h2 class="text-2xl font-bold mb-6">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div class="gradient-bg text-white rounded-lg p-4">
                            <p class="text-sm opacity-90">–û–±—â–∏–π –¥–æ—Ö–æ–¥</p>
                            <p class="text-2xl font-bold">{{ totalIncome }} ‚ÇΩ</p>
                        </div>
                        <div class="gradient-bg text-white rounded-lg p-4">
                            <p class="text-sm opacity-90">–û–±—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã</p>
                            <p class="text-2xl font-bold">{{ totalExpenses }} ‚ÇΩ</p>
                        </div>
                        <div class="gradient-bg text-white rounded-lg p-4">
                            <p class="text-sm opacity-90">–û—Å—Ç–∞—Ç–æ–∫</p>
                            <p class="text-2xl font-bold">{{ balance }} ‚ÇΩ</p>
                        </div>
                        <div class="gradient-bg text-white rounded-lg p-4">
                            <p class="text-sm opacity-90">–ö–§–ì</p>
                            <p class="text-2xl font-bold">{{ kfg }}</p>
                        </div>
                    </div>

                    <div class="bg-gray-50 rounded-lg p-4 mb-6">
                        <canvas id="expenseChart" style="height: 300px;"></canvas>
                    </div>

                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold mb-3">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h3>
                        <div class="space-y-2">
                            <div v-for="rec in recommendations" :key="rec" class="bg-white p-3 rounded-lg shadow-sm">
                                {{ rec }}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –í–∫–ª–∞–¥–∫–∞ —á–∞—Ç-–±–æ—Ç–∞ -->
                <div v-show="currentTab === 'chat'" class="p-6">
                    <h2 class="text-2xl font-bold mb-6">–ß–∞—Ç —Å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º —Å–æ–≤–µ—Ç–Ω–∏–∫–æ–º</h2>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <div class="h-96 overflow-y-auto flex flex-col space-y-2 mb-4" ref="chatContainer">
                            <div v-for="(msg, index) in chatMessages" :key="index" 
                                 :class="msg.sender === 'bot' ? 'message-bot' : 'message-user'">
                                {{ msg.text }}
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <textarea v-model="chatInput" @keyup.enter="sendMessage" rows="2" class="flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-500" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å..."></textarea>
                            <button @click="sendMessage" class="gradient-bg text-white px-6 rounded-lg font-semibold hover:shadow-lg">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- –í–∫–ª–∞–¥–∫–∞ –¥—Ä—É–∑–µ–π -->
                <div v-show="currentTab === 'friends'" class="p-6">
                    <h2 class="text-2xl font-bold mb-6">–î—Ä—É–∑—å—è</h2>
                    
                    <div class="bg-gray-50 rounded-lg p-4 mb-6">
                        <h3 class="text-lg font-semibold mb-3">–ù–∞–π—Ç–∏ –¥—Ä—É–≥–∞ –ø–æ –Ω–∏–∫–Ω–µ–π–º—É</h3>
                        <div class="flex space-x-2">
                            <input v-model="friendSearchQuery" type="text" 
                                   class="flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-500" 
                                   placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º (–Ω–∞–ø—Ä–∏–º–µ—Ä: @username)">
                            <button @click="searchFriends" class="gradient-bg text-white px-6 py-2 rounded-lg font-semibold hover:shadow-lg">
                                <i class="fas fa-search mr-2"></i>–ü–æ–∏—Å–∫
                            </button>
                        </div>
                        
                        <div v-if="searchResults.length > 0" class="mt-4">
                            <h4 class="text-sm font-medium text-gray-600 mb-2">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞:</h4>
                            <div class="space-y-2">
                                <div v-for="user in searchResults" :key="user.login" 
                                     class="bg-white p-3 rounded-lg flex justify-between items-center border">
                                    <div>
                                        <span class="font-medium">{{ user.name }} {{ user.surname }}</span>
                                        <span class="text-sm text-gray-500 ml-2">{{ user.nickname }}</span>
                                    </div>
                                    <button @click="addFriend(user)" 
                                            class="bg-green-500 text-white px-3 py-1 rounded-lg text-sm hover:bg-green-600">
                                        <i class="fas fa-user-plus mr-1"></i>–î–æ–±–∞–≤–∏—Ç—å –≤ –¥—Ä—É–∑—å—è
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div v-else-if="friendSearchQuery && searchPerformed" class="mt-4 text-gray-500 text-center py-4">
                            –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –Ω–∏–∫–Ω–µ–π–º–æ–º –Ω–µ –Ω–∞–π–¥–µ–Ω
                        </div>
                    </div>

                    <h3 class="text-lg font-semibold mb-3">–ú–æ–∏ –¥—Ä—É–∑—å—è ({{ friends.length }})</h3>
                    
                    <div v-if="friends.length === 0" class="bg-gray-50 rounded-lg p-8 text-center text-gray-500">
                        <i class="fas fa-user-friends text-4xl mb-3 opacity-50"></i>
                        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π</p>
                        <p class="text-sm">–ù–∞–π–¥–∏—Ç–µ –¥—Ä—É–∑–µ–π –ø–æ –Ω–∏–∫–Ω–µ–π–º—É –≤—ã—à–µ</p>
                    </div>
                    
                    <ul v-else class="space-y-2">
                        <li v-for="friend in friends" :key="friend.login" 
                            class="bg-gray-50 rounded-lg p-4 flex justify-between items-center hover:shadow-md transition">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 gradient-bg rounded-full flex items-center justify-center text-white font-bold">
                                    {{ friend.name.charAt(0) }}{{ friend.surname ? friend.surname.charAt(0) : '' }}
                                </div>
                                <div>
                                    <span class="font-medium block">{{ friend.name }} {{ friend.surname }}</span>
                                    <span class="text-sm text-gray-500">{{ friend.nickname }}</span>
                                </div>
                            </div>
                            <button @click="removeFriend(friend)" 
                                    class="text-red-500 hover:text-red-700">
                                <i class="fas fa-user-minus"></i>
                            </button>
                        </li>
                    </ul>
                </div>

                <!-- –í–∫–ª–∞–¥–∫–∞ –Ω–∞–≥—Ä–∞–¥ -->
                <div v-show="currentTab === 'rewards'" class="p-6">
                    <h2 class="text-2xl font-bold mb-6">–°–∏—Å—Ç–µ–º–∞ –Ω–∞–≥—Ä–∞–¥ –∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–π</h2>
                    
                    <div class="bg-gray-50 rounded-lg p-4 mb-6">
                        <h3 class="text-lg font-semibold mb-2">–í–∞—à –ö–§–ì: <span class="text-purple-600">{{ kfg }}</span></h3>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div v-for="reward in rewards" :key="reward.id" 
                             @click="claimReward(reward)"
                             :class="['rounded-lg p-4 text-center cursor-pointer transition-transform hover:scale-105',
                                      reward.kfgRequired <= kfg 
                                          ? 'bg-gradient-to-br from-yellow-400 to-orange-400' 
                                          : 'bg-gradient-to-br from-gray-300 to-gray-400 opacity-75']">
                            <i :class="['fas', reward.icon, 'text-3xl mb-2 text-white']"></i>
                            <h4 class="font-bold text-white mb-1">{{ reward.name }}</h4>
                            <p class="text-xs text-white opacity-90 mb-2">{{ reward.description }}</p>
                            <span class="inline-block bg-white bg-opacity-20 text-white px-2 py-1 rounded-full text-xs">
                                –ö–§–ì: {{ reward.kfgRequired }}
                            </span>
                        </div>
                    </div>

                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="text-lg font-semibold mb-3">–ù–∞–∫–∞–∑–∞–Ω–∏—è</h3>
                        <div v-for="penalty in penalties" :key="penalty" class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-2">
                            {{ penalty }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, reactive, computed, watch, onMounted } = Vue;

        const app = createApp({
            setup() {
                // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                const currentTab = ref('profile');
                const message = reactive({ show: false, text: '', type: 'success' });
                
                // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                const users = ref([]);
                const currentUser = ref(null);
                
                // –§–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                const loginForm = reactive({
                    login: '',
                    password: ''
                });
                
                const registerForm = reactive({
                    name: '',
                    surname: '',
                    nickname: '',
                    login: '',
                    password: '',
                    income: 0
                });
                
                // –†–∞—Å—Ö–æ–¥—ã
                const expenses = reactive({
                    food: 0, transport: 0, hobby: 0, selfcare: 0,
                    health: 0, housing: 0, entertainment: 0,
                    subscriptions: 0, education: 0, travel: 0
                });
                
                // –î—Ä—É–∑—å—è
                const friends = ref([]);
                const friendSearchQuery = ref('');
                const searchResults = ref([]);
                const searchPerformed = ref(false);
                
                // –ß–∞—Ç
                const chatMessages = ref([
                    { text: '–ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π —Å–æ–≤–µ—Ç–Ω–∏–∫. –ó–∞–¥–∞–π—Ç–µ –º–Ω–µ –≤–æ–ø—Ä–æ—Å –æ —Ñ–∏–Ω–∞–Ω—Å–∞—Ö –∏–ª–∏ –ø–æ–ø—Ä–æ—Å–∏—Ç–µ —Å–æ–≤–µ—Ç –ø–æ —ç–∫–æ–Ω–æ–º–∏–∏.', sender: 'bot' }
                ]);
                const chatInput = ref('');
                const chatContainer = ref(null);
                
                // –ù–∞–≥—Ä–∞–¥—ã
                const rewards = [
                    { id: 1, name: '–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–æ—Ñ–µ', kfgRequired: 50, description: '–°–∫–∏–¥–∫–∞ 50% –Ω–∞ –∫–æ—Ñ–µ', icon: 'fa-coffee' },
                    { id: 2, name: '–ö–∏–Ω–æ –æ–Ω–ª–∞–π–Ω', kfgRequired: 100, description: '–ú–µ—Å—è—Ü –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä', icon: 'fa-film' },
                    { id: 3, name: '–ö–Ω–∏–≥–∞', kfgRequired: 150, description: '–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –∫–Ω–∏–≥–∞ –≤ –ø–æ–¥–∞—Ä–æ–∫', icon: 'fa-book' },
                    { id: 4, name: '–°–ø–æ—Ä—Ç–∑–∞–ª', kfgRequired: 200, description: '–ú–µ—Å—è—Ü –≤ —Å–ø–æ—Ä—Ç–∑–∞–ª –±–µ—Å–ø–ª–∞—Ç–Ω–æ', icon: 'fa-dumbbell' },
                    { id: 5, name: '–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ', kfgRequired: 300, description: '–°–∫–∏–¥–∫–∞ –Ω–∞ –±–∏–ª–µ—Ç—ã 20%', icon: 'fa-plane' }
                ];
                
                // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
                const tabs = [
                    { id: 'profile', name: '–ü—Ä–æ—Ñ–∏–ª—å', icon: 'fas fa-user' },
                    { id: 'expenses', name: '–†–∞—Å—Ö–æ–¥—ã', icon: 'fas fa-chart-line' },
                    { id: 'analytics', name: '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞', icon: 'fas fa-chart-pie' },
                    { id: 'chat', name: '–ß–∞—Ç-–±–æ—Ç', icon: 'fas fa-robot' },
                    { id: 'friends', name: '–î—Ä—É–∑—å—è', icon: 'fas fa-users' },
                    { id: 'rewards', name: '–ù–∞–≥—Ä–∞–¥—ã', icon: 'fas fa-gift' }
                ];
                
                const categoryNames = {
                    food: '–ï–¥–∞', transport: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç', hobby: '–•–æ–±–±–∏',
                    selfcare: '–£—Ö–æ–¥', health: '–ó–¥–æ—Ä–æ–≤—å–µ', housing: '–ñ–∏–ª—å–µ',
                    entertainment: '–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è', subscriptions: '–ü–æ–¥–ø–∏—Å–∫–∏',
                    education: '–£—á–µ–±–∞', travel: '–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è'
                };
                
                const categoryIcons = {
                    food: 'fas fa-utensils', transport: 'fas fa-bus',
                    hobby: 'fas fa-palette', selfcare: 'fas fa-spa',
                    health: 'fas fa-heartbeat', housing: 'fas fa-home',
                    entertainment: 'fas fa-gamepad', subscriptions: 'fas fa-tv',
                    education: 'fas fa-book', travel: 'fas fa-plane'
                };
                
                const expenseCategories = computed(() => {
                    return Object.keys(expenses);
                });
                
                // –í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
                const totalExpenses = computed(() => {
                    return Object.values(expenses).reduce((a, b) => a + b, 0);
                });
                
                const totalIncome = computed(() => currentUser.value?.income || 0);
                
                const balance = computed(() => totalIncome.value - totalExpenses.value);
                
                const kfg = computed(() => {
                    if (!currentUser.value?.income || currentUser.value.income === 0) return 0;
                    
                    let value = 100 - (totalExpenses.value / currentUser.value.income * 100);
                    
                    if (expenses.education > 0) value += 10;
                    if (expenses.entertainment > currentUser.value.income * 0.3) value -= 20;
                    if (expenses.food > currentUser.value.income * 0.5) value -= 15;
                    
                    return Math.max(0, Math.min(100, Math.round(value)));
                });
                
                const recommendations = computed(() => {
                    if (!currentUser.value) return [];
                    
                    const recs = [];
                    
                    if (totalExpenses.value > currentUser.value.income) {
                        recs.push('‚ö†Ô∏è –í–∞—à–∏ —Ä–∞—Å—Ö–æ–¥—ã –ø—Ä–µ–≤—ã—à–∞—é—Ç –¥–æ—Ö–æ–¥! –°—Ä–æ—á–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç–µ —Ç—Ä–∞—Ç—ã.');
                    }
                    
                    if (expenses.entertainment > currentUser.value.income * 0.2) {
                        recs.push('üéØ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–æ 20% –æ—Ç –¥–æ—Ö–æ–¥–∞.');
                    }
                    
                    if (expenses.food > currentUser.value.income * 0.3) {
                        recs.push('üçé –ì–æ—Ç–æ–≤—å—Ç–µ –¥–æ–º–∞ —á–∞—â–µ - —ç—Ç–æ —Å—ç–∫–æ–Ω–æ–º–∏—Ç –¥–æ 50% –Ω–∞ –µ–¥–µ.');
                    }
                    
                    if (expenses.subscriptions > 1000) {
                        recs.push('üì± –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–ø–∏—Å–∫–∏ - –≤–æ–∑–º–æ–∂–Ω–æ, –≤—ã –ø–ª–∞—Ç–∏—Ç–µ –∑–∞ –Ω–µ–Ω—É–∂–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã.');
                    }
                    
                    if (expenses.education === 0) {
                        recs.push('üìö –ò–Ω–≤–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ - —ç—Ç–æ –ø–æ–≤—ã—Å–∏—Ç –≤–∞—à –±—É–¥—É—â–∏–π –¥–æ—Ö–æ–¥.');
                    }
                    
                    if (balance.value > 0) {
                        recs.push(`üí™ –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –í—ã –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç–µ ${balance.value} ‚ÇΩ –≤ –º–µ—Å—è—Ü.`);
                    }
                    
                    return recs;
                });
                
                const penalties = computed(() => {
                    if (!currentUser.value) return [];
                    
                    const pens = [];
                    
                    if (kfg.value < 30) {
                        pens.push('‚ö†Ô∏è –í–∞—à –ö–§–ì –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–∏–∑–∫–∏–π! –£–≤–µ–ª–∏—á—å—Ç–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç—å.');
                    }
                    
                    if (totalExpenses.value > currentUser.value.income * 0.9) {
                        pens.push('üìâ –í—ã —Ç—Ä–∞—Ç–∏—Ç–µ –ø–æ—á—Ç–∏ –≤–µ—Å—å –¥–æ—Ö–æ–¥ - —Å—Ä–æ—á–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç–µ —Ä–∞—Å—Ö–æ–¥—ã!');
                    }
                    
                    return pens;
                });
                
                // –ú–µ—Ç–æ–¥—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                function handleRegister() {
                    if (!registerForm.name || !registerForm.surname || !registerForm.nickname || 
                        !registerForm.login || !registerForm.password || !registerForm.income) {
                        showMessage('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                        return;
                    }
                    
                    if (users.value.some(u => u.login === registerForm.login)) {
                        showMessage('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç', 'error');
                        return;
                    }
                    
                    if (users.value.some(u => u.nickname === registerForm.nickname)) {
                        showMessage('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –Ω–∏–∫–Ω–µ–π–º–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç', 'error');
                        return;
                    }
                    
                    const newUser = {
                        name: registerForm.name,
                        surname: registerForm.surname,
                        nickname: registerForm.nickname,
                        login: registerForm.login,
                        password: registerForm.password,
                        income: Number(registerForm.income),
                        expenses: { ...expenses },
                        friends: []
                    };
                    
                    users.value.push(newUser);
                    currentUser.value = { ...newUser };
                    
                    showMessage('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!', 'success');
                    
                    // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                    registerForm.name = '';
                    registerForm.surname = '';
                    registerForm.nickname = '';
                    registerForm.login = '';
                    registerForm.password = '';
                    registerForm.income = 0;
                    
                    saveToStorage();
                }
                
                function handleLogin() {
                    if (!loginForm.login || !loginForm.password) {
                        showMessage('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                        return;
                    }
                    
                    const user = users.value.find(u => 
                        u.login === loginForm.login && u.password === loginForm.password
                    );
                    
                    if (user) {
                        currentUser.value = { ...user };
                        loadUserData(user);
                        showMessage('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!', 'success');
                        
                        loginForm.login = '';
                        loginForm.password = '';
                    } else {
                        showMessage('–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å', 'error');
                    }
                }
                
                function logout() {
                    currentUser.value = null;
                    
                    Object.keys(expenses).forEach(key => expenses[key] = 0);
                    friends.value = [];
                    
                    showMessage('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã', 'success');
                }
                
                function loadUserData(user) {
                    if (user.expenses) {
                        Object.assign(expenses, user.expenses);
                    }
                    
                    if (user.friends) {
                        friends.value = user.friends;
                    }
                    
                    updateChart();
                }
                
                // –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥—Ä—É–∑—å—è–º–∏
                function searchFriends() {
                    searchPerformed.value = true;
                    
                    if (!friendSearchQuery.value.trim()) {
                        searchResults.value = [];
                        return;
                    }
                    
                    const query = friendSearchQuery.value.toLowerCase();
                    
                    searchResults.value = users.value.filter(u => 
                        u.nickname.toLowerCase() === query && 
                        u.login !== currentUser.value?.login &&
                        !friends.value.some(f => f.login === u.login)
                    );
                }
                
                function addFriend(user) {
                    const newFriend = {
                        name: user.name,
                        surname: user.surname,
                        nickname: user.nickname,
                        login: user.login
                    };
                    
                    friends.value.push(newFriend);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –¥—Ä—É–∑–µ–π –≤ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    const userIndex = users.value.findIndex(u => u.login === currentUser.value?.login);
                    if (userIndex !== -1) {
                        users.value[userIndex].friends = [...friends.value];
                        currentUser.value.friends = [...friends.value];
                    }
                    
                    searchResults.value = [];
                    friendSearchQuery.value = '';
                    searchPerformed.value = false;
                    
                    showMessage(`–î—Ä—É–≥ ${user.name} –¥–æ–±–∞–≤–ª–µ–Ω!`, 'success');
                    saveToStorage();
                }
                
                function removeFriend(friend) {
                    friends.value = friends.value.filter(f => f.login !== friend.login);
                    
                    const userIndex = users.value.findIndex(u => u.login === currentUser.value?.login);
                    if (userIndex !== -1) {
                        users.value[userIndex].friends = [...friends.value];
                        currentUser.value.friends = [...friends.value];
                    }
                    
                    showMessage(`–î—Ä—É–≥ ${friend.name} —É–¥–∞–ª–µ–Ω`, 'success');
                    saveToStorage();
                }
                
                // –û—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
                let chart = null;
                
                function showMessage(text, type) {
                    message.text = text;
                    message.type = type;
                    message.show = true;
                    
                    setTimeout(() => {
                        message.show = false;
                    }, 3000);
                }
                
                function saveExpenses() {
                    const userIndex = users.value.findIndex(u => u.login === currentUser.value?.login);
                    if (userIndex !== -1) {
                        users.value[userIndex].expenses = { ...expenses };
                        currentUser.value.expenses = { ...expenses };
                    }
                    
                    saveToStorage();
                    showMessage('–†–∞—Å—Ö–æ–¥—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
                    updateChart();
                }
                
                function saveToStorage() {
                    const data = {
                        users: users.value,
                        currentUser: currentUser.value,
                    };
                    localStorage.setItem('vueFinancialData', JSON.stringify(data));
                }
                
                function loadFromStorage() {
                    const saved = localStorage.getItem('vueFinancialData');
                    if (saved) {
                        try {
                            const data = JSON.parse(saved);
                            users.value = data.users || [];
                            
                            if (data.currentUser) {
                                const userExists = users.value.some(u => u.login === data.currentUser.login);
                                if (userExists) {
                                    currentUser.value = data.currentUser;
                                    loadUserData(data.currentUser);
                                }
                            }
                        } catch (e) {
                            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏', e);
                        }
                    }
                }
                
                function initChart() {
                    const ctx = document.getElementById('expenseChart');
                    if (!ctx) return;
                    
                    if (chart) {
                        chart.destroy();
                    }
                    
                    chart = new Chart(ctx.getContext('2d'), {
                        type: 'doughnut',
                        data: {
                            labels: Object.values(categoryNames),
                            datasets: [{
                                data: Object.values(expenses),
                                backgroundColor: [
                                    '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0',
                                    '#9966FF', '#FF9F40', '#FF6384', '#36A2EB',
                                    '#FFCE56', '#4BC0C0'
                                ]
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { position: 'bottom' }
                            }
                        }
                    });
                }
                
                function updateChart() {
                    if (chart) {
                        chart.data.datasets[0].data = Object.values(expenses);
                        chart.update();
                    } else {
                        initChart();
                    }
                }
                
                async function sendMessage() {
                    if (!chatInput.value.trim()) return;
                    
                    chatMessages.value.push({
                        text: chatInput.value,
                        sender: 'user'
                    });
                    
                    chatInput.value = '';
                    
                    setTimeout(() => {
                        if (chatContainer.value) {
                            chatContainer.value.scrollTop = chatContainer.value.scrollHeight;
                        }
                    }, 100);
                    
                    setTimeout(() => {
                        const responses = [
                            "–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –≤–µ—Å—Ç–∏ —É—á–µ—Ç –≤—Å–µ—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤.",
                            "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª–æ 50/30/20: 50% –Ω–∞ –Ω—É–∂–Ω–æ–µ, 30% –Ω–∞ –∂–µ–ª–∞–Ω–∏—è, 20% –≤ –∫–æ–ø–∏–ª–∫—É.",
                            "–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± —ç–∫–æ–Ω–æ–º–∏–∏ - –≥–æ—Ç–æ–≤–∏—Ç—å –¥–æ–º–∞ –∏ –±—Ä–∞—Ç—å –µ–¥—É —Å —Å–æ–±–æ–π.",
                            "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—ç—à–±—ç–∫-—Å–µ—Ä–≤–∏—Å—ã –∏ —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –∞–∫—Ü–∏—è–º–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–∞—Ö.",
                            "–û—Ç–ª–æ–∂–∏—Ç–µ 10% –¥–æ—Ö–æ–¥–∞ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è - —Ç–∞–∫ –≤—ã –Ω–µ –ø–æ—Ç—Ä–∞—Ç–∏—Ç–µ –∏—Ö.",
                            "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ –ø–ª–∞—Ç–∏—Ç–µ –ª–∏ –≤—ã –∑–∞ –Ω–µ–Ω—É–∂–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏."
                        ];
                        
                        chatMessages.value.push({
                            text: responses[Math.floor(Math.random() * responses.length)],
                            sender: 'bot'
                        });
                        
                        if (chatContainer.value) {
                            chatContainer.value.scrollTop = chatContainer.value.scrollHeight;
                        }
                    }, 1000);
                }
                
                function claimReward(reward) {
                    if (reward.kfgRequired <= kfg.value) {
                        showMessage(`–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –ø–æ–ª—É—á–∏–ª–∏: ${reward.name}`, 'success');
                    } else {
                        showMessage('–£ –≤–∞—Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ö–§–ì –¥–ª—è —ç—Ç–æ–π –Ω–∞–≥—Ä–∞–¥—ã', 'error');
                    }
                }
                
                function exportData() {
                    const data = {
                        user: currentUser.value,
                        expenses: { ...expenses },
                        friends: friends.value,
                        exportDate: new Date().toISOString()
                    };
                    
                    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `financial_data_${new Date().toISOString().split('T')[0]}.json`;
                    a.click();
                    
                    showMessage('–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!', 'success');
                }
                
                onMounted(() => {
                    loadFromStorage();
                    
                    setTimeout(() => {
                        initChart();
                    }, 100);
                });
                
                watch([expenses, friends], () => {
                    if (currentUser.value) {
                        saveToStorage();
                    }
                }, { deep: true });
                
                return {
                    currentTab,
                    message,
                    currentUser,
                    loginForm,
                    registerForm,
                    expenses,
                    friends,
                    friendSearchQuery,
                    searchResults,
                    searchPerformed,
                    chatMessages,
                    chatInput,
                    chatContainer,
                    rewards,
                    tabs,
                    categoryNames,
                    categoryIcons,
                    expenseCategories,
                    totalExpenses,
                    totalIncome,
                    balance,
                    kfg,
                    recommendations,
                    penalties,
                    handleRegister,
                    handleLogin,
                    logout,
                    searchFriends,
                    addFriend,
                    removeFriend,
                    saveExpenses,
                    sendMessage,
                    claimReward,
                    exportData
                };
            }
        });
        
        app.mount('#app');
    </script>
</body>
</html>
